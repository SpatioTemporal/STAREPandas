import starepandas
import geopandas

countries = {
    "pop_est": [
        44938712.0, 18952038.0, 3398.0, 3461734.0, 211049527.0,
        11513100.0, 32510453.0, 50339443.0, 28515829.0, 782766.0,
        581363.0, 17373662.0, 7044636.0
    ],
    "continent": [
        "South America", "South America", "South America", "South America", "South America",
        "South America", "South America", "South America", "South America", "South America",
        "South America", "South America", "South America"
    ],
    "name": [
        "Argentina", "Chile", "Falkland Is.", "Uruguay", "Brazil",
        "Bolivia", "Peru", "Colombia", "Venezuela", "Guyana",
        "Suriname", "Ecuador", "Paraguay"
    ],
    "iso_a3": [
        "ARG", "CHL", "FLK", "URY", "BRA",
        "BOL", "PER", "COL", "VEN", "GUY",
        "SUR", "ECU", "PRY"
    ],
    "gdp_md_est": [
        445445, 282318, 282, 56045, 1839758,
        40895, 226848, 323615, 482359, 5173,
        3697, 107435, 38145
    ],
    "geometry": [
        # Argentina
        "MULTIPOLYGON (((-68.63401022758323 -52.63637045887449, -68.25 -53.1, -67.75 -53.85, -66.45 -54.45, -65.05 -54.7, -65.5 -55.2, -66.45 -55.25, -66.95992000000001 -54.89681000000002, -67.56244 -54.87001, -68.63335000000001 -54.8695, -68.63401022758323 -52.63637045887449)), ((-57.62513342958296 -30.21629485445426, -57.87493730328188 -31.01655608492621, -58.14244035504076 -32.04450367607615, -58.13264767112145 -33.04056690850202, -58.34961117209888 -33.26318897881541, -58.42707414410439 -33.90945444105758, -58.49544206402655 -34.43148976007008, -57.22582963726366 -35.28802662530788, -57.36235877137878 -35.97739023208148, -56.73748735210545 -36.41312590916655, -56.78828528504836 -36.90157154718933, -57.74915686708346 -38.18387053807989, -59.23185706240189 -38.72022022883723, -61.23744523786564 -38.9284245745412, -62.33595699731013 -38.82770720800433, -62.12576310896294 -39.42410491308485, -62.33053097191949 -40.17258635840034, -62.14599443220521 -40.67689666113672, -62.74580278181698 -41.0287614886121, -63.77049475773255 -41.16678923926369, -64.73208980981973 -40.80267709733515, -65.11803524439158 -41.06431487402891, -64.97856055363582 -42.05800099056934, -64.30340796574249 -42.35901620866951, -63.75594784204239 -42.04368661882449, -63.45805904809588 -42.5631381162224, -64.37880388045633 -42.87355844499969, -65.18180396183975 -43.4953809547678, -65.32882341171013 -44.5013660621937, -65.56526892766161 -45.03678557716979, -66.50996578638934 -45.03962778094586, -67.29379391139247 -45.55189625425519, -67.58054643418008 -46.30177296324257, -66.59706641301729 -47.03392465595383, -65.64102657740149 -47.23613453551193, -65.98508826360079 -48.13328907653113, -67.16617896184769 -48.69733733499694, -67.81608761256643 -49.86966887797038, -68.72874508327321 -50.26421843851883, -69.13853919134777 -50.7325102679478, -68.81556148952356 -51.77110401159413, -68.14999487982038 -52.34998340612768, -68.57154537624133 -52.29944385534623, -69.49836218939609 -52.14276091263727, -71.91480383979638 -52.0090223058659, -72.32940385607407 -51.42595631287243, -72.30997351753234 -50.67700977966632, -72.97574683296469 -50.74145029073429, -73.32805091011453 -50.37878508890991, -73.41543575712009 -49.31843637471297, -72.64824744331494 -48.87861825947683, -72.33116085477201 -48.2442383766618, -72.44735531278027 -47.73853281025352, -71.91725847033024 -46.88483814879177, -71.55200944689128 -45.5607329241771, -71.65931555854536 -44.97368865334143, -71.22277889675976 -44.78424285255942, -71.32980078803622 -44.40752166115166, -71.79362260607193 -44.20717213315606, -71.46405615913051 -43.78761117937835, -71.91542395698389 -43.40856454851745, -72.14889807807856 -42.25488819760137, -71.7468037584155 -42.05138640723598, -71.91573401557763 -40.83233936947069, -71.68076127794649 -39.80816415787805, -71.41351660834906 -38.91602223079114, -70.81466427273469 -38.55299529394074, -71.11862504747549 -37.57682748794724, -71.12188066270987 -36.65812387466232, -70.36476925320164 -36.00508879978992, -70.38804948594913 -35.16968759535949, -69.81730912950152 -34.1935714657983, -69.81477698431922 -33.27388600029983, -70.07439938015359 -33.09120981214805, -70.53506893581951 -31.36501026787031, -69.91900834825194 -30.33633920666828, -70.01355038112992 -29.36792286551857, -69.65613033718317 -28.45914112723369, -69.00123491074825 -27.52121388113618, -68.29554155137043 -26.89933969493578, -68.59479977077268 -26.5069088681113, -68.38600114609736 -26.18501637136522, -68.41765296087614 -24.51855478281688, -67.32844295924417 -24.02530323659095, -66.9852339341777 -22.98634856536284, -67.1066735500636 -22.73592457447642, -66.27333940292485 -21.83231047942072, -64.96489213729461 -22.07586150481233, -64.37702104354226 -22.79809132252354, -63.98683814152248 -21.99364430103595, -62.84646847192156 -22.03498544686945, -62.68505713565789 -22.24902922942239, -60.84656470400991 -23.88071257903829, -60.02896603050403 -24.03279631927327, -58.80712846539498 -24.77145924245331, -57.77721716981794 -25.16233977630904, -57.63366004091113 -25.60365650808164, -58.61817359071975 -27.1237187639471, -57.60975969097614 -27.39589853282839, -56.486701626193 -27.54849903738629, -55.69584550639816 -27.38783700939086, -54.78879492859505 -26.62178557709613, -54.62529069682358 -25.73925546641551, -54.13004960795439 -25.54763925547725, -53.62834896504874 -26.12486500417747, -53.64873531758789 -26.92347258881609, -54.49072526713552 -27.47475676850579, -55.16228634298457 -27.88191537853346, -56.29089962423908 -28.85276051200089, -57.62513342958296 -30.21629485445426)))",
        # Chile
        "MULTIPOLYGON (((-68.63401022758323 -52.63637045887449, -68.63335000000001 -54.8695, -67.56244 -54.87001, -66.95992000000001 -54.89681000000002, -67.29102999999992 -55.30123999999995, -68.14862999999991 -55.61183, -68.63999081081187 -55.58001799908692, -69.2321 -55.49905999999993, -69.95808999999997 -55.19843000000003, -71.00567999999998 -55.05383, -72.26390000000004 -54.49513999999999, -73.28519999999997 -53.95751999999993, -74.66253 -52.83748999999995, -73.8381 -53.04743000000002, -72.43417999999997 -53.71539999999999, -71.10773 -54.07432999999992, -70.59177999999986 -53.61582999999996, -70.26747999999998 -52.93123000000003, -69.34564999999992 -52.51829999999995, -68.63401022758323 -52.63637045887449)), ((-69.59042375352405 -17.58001189541933, -69.10024695501949 -18.26012542081268, -68.96681840684187 -18.98168344490411, -68.44222510443092 -19.40506845467143, -68.75716712103375 -20.37265797290446, -68.21991309271128 -21.49434661223187, -67.82817989772273 -22.87291879648217, -67.1066735500636 -22.73592457447642, -66.9852339341777 -22.98634856536284, -67.32844295924417 -24.02530323659095, -68.41765296087614 -24.51855478281688, -68.38600114609736 -26.18501637136522, -68.59479977077268 -26.5069088681113, -68.29554155137043 -26.89933969493578, -69.00123491074825 -27.52121388113618, -69.65613033718317 -28.45914112723369, -70.01355038112992 -29.36792286551857, -69.91900834825194 -30.33633920666828, -70.53506893581951 -31.36501026787031, -70.07439938015359 -33.09120981214805, -69.81477698431922 -33.27388600029983, -69.81730912950152 -34.1935714657983, -70.38804948594913 -35.16968759535949, -70.36476925320164 -36.00508879978992, -71.12188066270987 -36.65812387466232, -71.11862504747549 -37.57682748794724, -70.81466427273469 -38.55299529394074, -71.41351660834906 -38.91602223079114, -71.68076127794649 -39.80816415787805, -71.91573401557763 -40.83233936947069, -71.7468037584155 -42.05138640723598, -72.14889807807856 -42.25488819760137, -71.91542395698389 -43.40856454851745, -71.46405615913051 -43.78761117937835, -71.79362260607193 -44.20717213315606, -71.32980078803622 -44.40752166115166, -71.22277889675976 -44.78424285255942, -71.65931555854536 -44.97368865334143, -71.55200944689128 -45.5607329241771, -71.91725847033024 -46.88483814879177, -72.44735531278027 -47.73853281025352, -72.33116085477201 -48.2442383766618, -72.64824744331494 -48.87861825947683, -73.41543575712009 -49.31843637471297, -73.32805091011453 -50.37878508890991, -72.97574683296469 -50.74145029073429, -72.30997351753234 -50.67700977966632, -72.32940385607407 -51.42595631287243, -71.91480383979638 -52.0090223058659, -69.49836218939609 -52.14276091263727, -68.57154537624133 -52.29944385534623, -69.46128434922667 -52.29195077266391, -69.9427795071062 -52.53793059037322, -70.8451016913546 -52.89920052852571, -71.00633216010525 -53.83325204220132, -71.429794684521 -53.85645476030037, -72.55794287788488 -53.53141000118449, -73.7027567206629 -52.83506926860723, -73.7027567206629 -52.83507007605149, -74.94676347522517 -52.262753588419, -75.26002600777851 -51.62935475037325, -74.97663245308988 -51.0433956846157, -75.47975419788355 -50.37837167745158, -75.60801510283198 -48.67377288187184, -75.18276974150216 -47.7119194476232, -74.12658098010471 -46.93925343199511, -75.64439531116545 -46.64764332457207, -74.69215369332312 -45.76397633238103, -74.35170935738425 -44.10304412208794, -73.24035600451522 -44.4549606259956, -72.71780392117979 -42.38335580827898, -73.38889990913822 -42.11753224056957, -73.70133561877488 -43.36577646257977, -74.33194312203261 -43.22495818458442, -74.01795711942719 -41.79481292090683, -73.67709937202999 -39.94221282324317, -73.21759253609065 -39.25868865331856, -73.50555945503712 -38.28288258235111, -73.58806087919109 -37.15628468195598, -73.1667170884993 -37.12378020604439, -72.55313696968174 -35.50884002049106, -71.86173214383263 -33.90909270603153, -71.4384504869299 -32.41889942803078, -71.66872066922247 -30.92064462659249, -71.37008256700773 -30.09568206148503, -71.48989437527645 -28.86144215262592, -70.90512386746161 -27.64037973400125, -70.72495398627599 -25.70592416758726, -70.40396582709502 -23.62899667734457, -70.09124589708074 -21.39331918710126, -70.16441972520605 -19.75646819425616, -70.37257239447771 -18.34797535570887, -69.85844356960587 -18.09269378018701, -69.59042375352405 -17.58001189541933)))",
        # Falkland Is.
        "POLYGON ((-61.2 -51.85, -60 -51.25, -59.15 -51.5, -58.55 -51.10000000000001, -57.75 -51.55, -58.05 -51.90000000000001, -59.40000000000001 -52.2, -59.85000000000001 -51.85, -60.7 -52.3, -61.2 -51.85))",
        # Uruguay
        "POLYGON ((-57.62513342958296 -30.21629485445426, -56.97602576356473 -30.10968637463613, -55.97324459494094 -30.8830758603163, -55.60151017924935 -30.85387867607139, -54.57245154480512 -31.49451140719375, -53.78795162618219 -32.04724252698762, -53.20958899597154 -32.72766611097472, -53.6505439927181 -33.20200408298183, -53.37366166849824 -33.76837778090076, -53.80642595072653 -34.39681487400223, -54.93586605489773 -34.95264657973362, -55.67408972840329 -34.75265878676407, -56.21529700379607 -34.85983570733742, -57.1396850246331 -34.43045623142424, -57.81786068381551 -34.4625472958775, -58.42707414410439 -33.90945444105758, -58.34961117209888 -33.26318897881541, -58.13264767112145 -33.04056690850202, -58.14244035504076 -32.04450367607615, -57.87493730328188 -31.01655608492621, -57.62513342958296 -30.21629485445426))",
        # Brazil
        "POLYGON ((-53.37366166849824 -33.76837778090076, -53.6505439927181 -33.20200408298183, -53.20958899597154 -32.72766611097472, -53.78795162618219 -32.04724252698762, -54.57245154480512 -31.49451140719375, -55.60151017924935 -30.85387867607139, -55.97324459494094 -30.8830758603163, -56.97602576356473 -30.10968637463613, -57.62513342958296 -30.21629485445426, -56.29089962423908 -28.85276051200089, -55.16228634298457 -27.88191537853346, -54.49072526713552 -27.47475676850579, -53.64873531758789 -26.92347258881609, -53.62834896504874 -26.12486500417747, -54.13004960795439 -25.54763925547725, -54.62529069682358 -25.73925546641551, -54.42894609233059 -25.16218474701217, -54.29347632507745 -24.57079965586396, -54.29295956075452 -24.02101409271073, -54.65283423523513 -23.83957813893396, -55.02790178080955 -24.00127369557523, -55.40074723979542 -23.9569353166688, -55.51763932963964 -23.57199757252664, -55.61068274598114 -22.65561939869485, -55.79795813660691 -22.35692962004782, -56.47331743022939 -22.08630014413528, -56.8815095689029 -22.28215382252148, -57.93715572776129 -22.09017587655717, -57.8706739976178 -20.73268767668195, -58.16639238140804 -20.17670094165368, -57.85380164247451 -19.96999521248619, -57.94999732118583 -19.40000416430682, -57.67600887717431 -18.96183969490403, -57.49837114117099 -18.17418751391129, -57.734558274961 -17.55246835700777, -58.28080400250225 -17.27171030036602, -58.38805843772404 -16.87710906338528, -58.24121985536668 -16.29957325609129, -60.15838965517904 -16.25828378669009, -60.54296566429515 -15.0939104142896, -60.25114885114294 -15.07721892665932, -60.26432634137737 -14.64597909918364, -60.45919816755003 -14.35400725673455, -60.50330400251114 -13.77595468511766, -61.08412126325565 -13.4793836401946, -61.71320431176078 -13.48920216233005, -62.12708085798639 -13.19878061284972, -62.80306026879639 -13.00065317144269, -63.19649878605057 -12.62703256597243, -64.3163529120316 -12.46197804123219, -65.40228146021303 -11.56627044031715, -65.32189876978302 -10.89587208419468, -65.44483700220539 -10.51145110437543, -65.33843522811642 -9.761987806846392, -66.64690833196281 -9.931331475466862, -67.17380123561074 -10.30681243249961, -68.04819230820539 -10.71205901453249, -68.27125362819326 -11.01452117273682, -68.78615759954948 -11.03638030359628, -69.52967810736496 -10.95173430750219, -70.09375220404689 -11.12397185633101, -70.54868567572841 -11.00914682377847, -70.48189388699117 -9.490118096558845, -71.30241227892154 -10.07943613041537, -72.18489071316985 -10.05359791426943, -72.56303300646564 -9.520193780152717, -73.22671342639016 -9.462212823121234, -73.01538265653255 -9.032833347208062, -73.57105933296707 -8.424446709835834, -73.98723548042966 -7.523829847853065, -73.7234014553635 -7.340998630404414, -73.72448666044164 -6.91859547285064, -73.1200274319236 -6.629930922068239, -73.21971126981461 -6.089188734566078, -72.9645072089412 -5.741251315944893, -72.89192765978726 -5.274561455916981, -71.74840572781655 -4.593982842633011, -70.92884334988358 -4.401591485210368, -70.7947688463023 -4.251264743673303, -69.89363521999663 -4.298186944194327, -69.44410193548961 -1.556287123219818, -69.42048580593223 -1.122618503426409, -69.5770653957766 -0.549991957200163, -70.02065589057005 -0.1851563452195393, -70.01556576198931 0.5414142928042054, -69.45239600287246 0.7061587589506929, -69.25243404811906 0.6026508650700748, -69.21863766140018 0.9856765812174331, -69.80459672715773 1.089081122233466, -69.81697323269162 1.714805202639624, -67.86856502955884 1.692455145673392, -67.5378100246747 2.03716278727633, -67.25999752467359 1.719998684084956, -67.0650481838525 1.130112209473225, -66.87632585312258 1.253360500489336, -66.32576514348496 0.7244522159820121, -65.54826738143757 0.7892544620760303, -65.35471330428837 1.0952822941085, -64.61101192895987 1.328730576987042, -64.19930579289051 1.49285492594602, -64.08308549666609 1.91636912679408, -63.36878801131166 2.200899562993129, -63.42286739770512 2.411067613124175, -64.2699991522658 2.497005520025567, -64.40882788761792 3.126786200366624, -64.36849443221411 3.797210394705246, -64.81606401229402 4.056445217297423, -64.62865943058755 4.14848094320925, -63.88834286157416 4.020530096854571, -63.09319759789911 3.770571193858785, -62.80453304711671 4.006965033377952, -62.08542965355913 4.162123521334308, -60.96689327660154 4.536467596856639, -60.60117916527194 4.91809804933213, -60.73357418480372 5.200277207861901, -60.21368343773133 5.244486395687602, -59.98095862490489 5.014061184098139, -60.11100236676738 4.574966538914083, -59.76740576845872 4.423502915866607, -59.53803992373123 3.958802598481938, -59.81541317405787 3.606498521332085, -59.97452490908456 2.755232652188056, -59.71854570172675 2.24963043864436, -59.64604366722126 1.786893825686789, -59.03086157900265 1.317697658692722, -58.5400129868783 1.268088283692521, -58.42947709820596 1.463941962078721, -58.11344987652502 1.507195135907025, -57.66097103537737 1.682584947105639, -57.3358229233969 1.948537705895759, -56.78270423036083 1.863710842288654, -56.53938574891455 1.899522609866921, -55.99569800477175 1.817667141116601, -55.90560014507088 2.02199575439866, -56.0733418442903 2.220794989425499, -55.97332210958938 2.510363877773017, -55.569755011606 2.421506252447131, -55.09758744975514 2.523748073736613, -54.52475419779972 2.311848863123785, -54.08806250671725 2.105556545414629, -53.77852067728892 2.376702785650082, -53.55483924011354 2.334896551925951, -53.41846513529531 2.053389187015981, -52.93965715189496 2.124857692875636, -52.55642473001842 2.504705308437053, -52.24933753112396 3.241094468596245, -51.65779741067889 4.156232408053029, -51.31714636901086 4.203490505383954, -51.06977128762966 3.650397650564031, -50.50887529153366 1.901563828942457, -49.97407589374506 1.736483465986069, -49.94710079608871 1.046189683431223, -50.69925126809692 0.2229841170216815, -50.38821082213214 -0.07844451253681939, -48.62056677915632 -0.2354891902718208, -48.58449662941659 -1.237805271005001, -47.82495642759064 -0.5816179337628, -46.56658362485123 -0.941027520352776, -44.90570309099041 -1.551739597178134, -44.41761918799367 -2.137750339367976, -44.58158850765578 -2.691308282078524, -43.41879126644019 -2.383110039889793, -41.47265682632825 -2.912018324397116, -39.97866533055404 -2.873054294449041, -38.50038347019657 -3.700652357603396, -37.2232521225352 -4.820945733258917, -36.45293738457639 -5.109403578312154, -35.59779578301047 -5.149504489770649, -35.23538896334756 -5.464937432480247, -34.89602983248683 -6.738193047719711, -34.72999345553303 -7.343220716992967, -35.12821204277422 -8.996401462442286, -35.63696651868771 -9.649281508017815, -37.046518724097 -11.0407211239088, -37.68361161960736 -12.17119475672582, -38.42387651218844 -13.03811858485429, -38.67388709161652 -13.05765227626062, -38.95327572280254 -13.79336964280002, -38.88229814304965 -15.66705372483877, -39.16109249526431 -17.20840667080847, -39.2673392400564 -17.86774627042048, -39.58352149103423 -18.26229583096894, -39.76082333022764 -19.59911345792741, -40.77474077001034 -20.90451181405242, -40.94475623225061 -21.93731698983781, -41.75416419123822 -22.37067555103746, -41.98828426773656 -22.9700704891909, -43.07470374202475 -22.96769337330547, -44.64781185563781 -23.35195932382784, -45.35213578955992 -23.79684172942858, -46.47209326840554 -24.08896860117454, -47.64897233742066 -24.88519906992772, -48.4954581365777 -25.87702483490565, -48.64100480812774 -26.62369760509093, -48.47473588722865 -27.17591196056189, -48.66152035174763 -28.18613453543572, -48.8884574041574 -28.67411508556788, -49.58732947447267 -29.22446908947634, -50.69687415221149 -30.98446502047296, -51.57622616230616 -31.77769825615321, -52.25608130553805 -32.24536996839467, -52.71209998229769 -33.19657805759118, -53.37366166849824 -33.76837778090076))",
        # Bolivia
        "POLYGON ((-69.52967810736496 -10.95173430750219, -68.78615759954948 -11.03638030359628, -68.27125362819326 -11.01452117273682, -68.04819230820539 -10.71205901453249, -67.17380123561074 -10.30681243249961, -66.64690833196281 -9.931331475466862, -65.33843522811642 -9.761987806846392, -65.44483700220539 -10.51145110437543, -65.32189876978302 -10.89587208419468, -65.40228146021303 -11.56627044031715, -64.3163529120316 -12.46197804123219, -63.19649878605057 -12.62703256597243, -62.80306026879639 -13.00065317144269, -62.12708085798639 -13.19878061284972, -61.71320431176078 -13.48920216233005, -61.08412126325565 -13.4793836401946, -60.50330400251114 -13.77595468511766, -60.45919816755003 -14.35400725673455, -60.26432634137737 -14.64597909918364, -60.25114885114294 -15.07721892665932, -60.54296566429515 -15.0939104142896, -60.15838965517904 -16.25828378669009, -58.24121985536668 -16.29957325609129, -58.38805843772404 -16.87710906338528, -58.28080400250225 -17.27171030036602, -57.734558274961 -17.55246835700777, -57.49837114117099 -18.17418751391129, -57.67600887717431 -18.96183969490403, -57.94999732118583 -19.40000416430682, -57.85380164247451 -19.96999521248619, -58.16639238140804 -20.17670094165368, -58.18347144228051 -19.86839934660036, -59.11504248720611 -19.3569060197754, -60.04356462262649 -19.34274667732743, -61.78632646345377 -19.63373666756296, -62.2659612697708 -20.51373463306128, -62.29117936872922 -21.05163461678739, -62.68505713565789 -22.24902922942239, -62.84646847192156 -22.03498544686945, -63.98683814152248 -21.99364430103595, -64.37702104354226 -22.79809132252354, -64.96489213729461 -22.07586150481233, -66.27333940292485 -21.83231047942072, -67.1066735500636 -22.73592457447642, -67.82817989772273 -22.87291879648217, -68.21991309271128 -21.49434661223187, -68.75716712103375 -20.37265797290446, -68.44222510443092 -19.40506845467143, -68.96681840684187 -18.98168344490411, -69.10024695501949 -18.26012542081268, -69.59042375352405 -17.58001189541933, -68.95963538275331 -16.50069793057127, -69.38976416693471 -15.66012908291165, -69.16034664577495 -15.32397389085302, -69.33953467474701 -14.95319548915883, -68.94888668483659 -14.45363941819328, -68.92922380234954 -13.60268360764301, -68.88007951523997 -12.89972909917665, -68.66507971868963 -12.56130014409717, -69.52967810736496 -10.95173430750219))",
        # Peru
        "POLYGON ((-69.89363521999663 -4.298186944194327, -70.7947688463023 -4.251264743673303, -70.92884334988358 -4.401591485210368, -71.74840572781655 -4.593982842633011, -72.89192765978726 -5.274561455916981, -72.9645072089412 -5.741251315944893, -73.21971126981461 -6.089188734566078, -73.1200274319236 -6.629930922068239, -73.72448666044164 -6.91859547285064, -73.7234014553635 -7.340998630404414, -73.98723548042966 -7.523829847853065, -73.57105933296707 -8.424446709835834, -73.01538265653255 -9.032833347208062, -73.22671342639016 -9.462212823121234, -72.56303300646564 -9.520193780152717, -72.18489071316985 -10.05359791426943, -71.30241227892154 -10.07943613041537, -70.48189388699117 -9.490118096558845, -70.54868567572841 -11.00914682377847, -70.09375220404689 -11.12397185633101, -69.52967810736496 -10.95173430750219, -68.66507971868963 -12.56130014409717, -68.88007951523997 -12.89972909917665, -68.92922380234954 -13.60268360764301, -68.94888668483659 -14.45363941819328, -69.33953467474701 -14.95319548915883, -69.16034664577495 -15.32397389085302, -69.38976416693471 -15.66012908291165, -68.95963538275331 -16.50069793057127, -69.59042375352405 -17.58001189541933, -69.85844356960587 -18.09269378018701, -70.37257239447771 -18.34797535570887, -71.37525021023693 -17.77379851651386, -71.46204077827113 -17.36348764411638, -73.44452958850042 -16.359362888253, -75.23788265654144 -15.26568287522778, -76.00920508492995 -14.64928639085032, -76.42346920439775 -13.82318694423243, -76.25924150257417 -13.53503915777294, -77.10619238962184 -12.22271615972082, -78.09215287953464 -10.37771249760407, -79.03695309112695 -8.386567884965892, -79.44592037628485 -7.93083342858386, -79.76057817251005 -7.194340915560084, -80.53748165558608 -6.541667575713717, -81.24999630402642 -6.136834405139183, -80.92634680858244 -5.690556735866565, -81.41094255239946 -4.736764825055459, -81.09966956248937 -4.036394138203697, -80.30256059438722 -3.404856459164713, -80.18401485870967 -3.821161797708044, -80.46929460317695 -4.059286797708999, -80.44224199087216 -4.425724379090674, -80.02890804718561 -4.346090996928893, -79.62497921417618 -4.454198093283495, -79.20528906931773 -4.959128513207389, -78.63989722361234 -4.547784112164074, -78.45068396677564 -3.873096612161376, -77.83790483265861 -3.003020521663103, -76.63539425322672 -2.608677666843818, -75.54499569365204 -1.56160979574588, -75.23372270374195 -0.9114169246495294, -75.37322323271385 -0.1520317521204504, -75.10662451852008 -0.05720549886486026, -74.44160051135597 -0.5308200008198867, -74.12239518908906 -1.002832533373848, -73.6595035468346 -1.260491224781134, -73.07039221870724 -2.308954359550953, -72.32578650581365 -2.434218031426454, -71.7747607082854 -2.169789727388938, -71.41364579942979 -2.342802422702128, -70.81347571479196 -2.256864515800743, -70.04770850287485 -2.725156345229699, -70.69268205430971 -3.742872002785859, -70.39404395209499 -3.766591485207825, -69.89363521999663 -4.298186944194327))",
        # Colombia
        "POLYGON ((-66.87632585312258 1.253360500489336, -67.0650481838525 1.130112209473225, -67.25999752467359 1.719998684084956, -67.5378100246747 2.03716278727633, -67.86856502955884 1.692455145673392, -69.81697323269162 1.714805202639624, -69.80459672715773 1.089081122233466, -69.21863766140018 0.9856765812174331, -69.25243404811906 0.6026508650700748, -69.45239600287246 0.7061587589506929, -70.01556576198931 0.5414142928042054, -70.02065589057005 -0.1851563452195393, -69.5770653957766 -0.549991957200163, -69.42048580593223 -1.122618503426409, -69.44410193548961 -1.556287123219818, -69.89363521999663 -4.298186944194327, -70.39404395209499 -3.766591485207825, -70.69268205430971 -3.742872002785859, -70.04770850287485 -2.725156345229699, -70.81347571479196 -2.256864515800743, -71.41364579942979 -2.342802422702128, -71.7747607082854 -2.169789727388938, -72.32578650581365 -2.434218031426454, -73.07039221870724 -2.308954359550953, -73.6595035468346 -1.260491224781134, -74.12239518908906 -1.002832533373848, -74.44160051135597 -0.5308200008198867, -75.10662451852008 -0.05720549886486026, -75.37322323271385 -0.1520317521204504, -75.8014658271166 0.08480133707320192, -76.29231441924097 0.4160472680641192, -76.5763797675494 0.256935533037435, -77.4249843004304 0.395686753741117, -77.66861284047044 0.8258930525709616, -77.85506140817952 0.8099250349927729, -78.85525875518871 1.380923773601822, -78.99093522817104 1.691369940595251, -78.61783138702371 1.766404120283056, -78.66211808949785 2.267355454920477, -78.42761043975733 2.629555568854215, -77.93154252797149 2.696605739752926, -77.51043128122501 3.325016994638247, -77.12768978545526 3.849636135265357, -77.49627193877703 4.087606105969428, -77.3076012844794 4.667984117039452, -77.53322058786573 5.582811997902497, -77.31881507028675 5.84535411216136, -77.47666073272228 6.691116441266303, -77.88157141794525 7.223771267114785, -77.7534138658614 7.709839789252143, -77.43110795765699 7.638061224798734, -77.24256649444008 7.935278225125444, -77.47472286651133 8.524286200388218, -77.35336076527386 8.67050466555807, -76.83667395700357 8.638749497914716, -76.08638383655786 9.336820583529487, -75.67460018584006 9.443248195834599, -75.66470414905618 9.774003200718738, -75.48042599150335 10.61899038333931, -74.90689510771199 11.08304474532032, -74.27675269234489 11.10203583418759, -74.1972226630477 11.31047272383687, -73.41476396350029 11.22701528568548, -72.62783525255963 11.73197154382552, -72.23819495307892 11.95554962813633, -71.75409013536864 12.43730316817731, -71.39982235379171 12.37604075769529, -71.13746110704588 12.11298187911351, -71.3315836249503 11.77628408451581, -71.97392167833829 11.60867157637712, -72.22757544624294 11.10870209395324, -72.61465776232521 10.82197540938178, -72.90528601753471 10.45034434655477, -73.02760413276957 9.736770331252444, -73.30495154488005 9.151999823437606, -72.78872982450039 9.085027167187334, -72.66049475776811 8.625287787302682, -72.43986223009796 8.405275376820029, -72.36090064155597 8.002638454617895, -72.47967892117885 7.632506008327354, -72.44448727078807 7.423784898300482, -72.19835242378188 7.340430813013683, -71.96017574734864 6.991614895043539, -70.67423356798152 7.087784735538719, -70.09331295437242 6.96037649172311, -69.38947994655712 6.099860541198836, -68.98531856960236 6.206804917826858, -68.26505245631823 6.153268133972475, -67.69508724635502 6.267318020040647, -67.34143958196557 6.095468044454023, -67.52153194850275 5.556870428891969, -67.74469662135522 5.221128648291668, -67.82301225449355 4.503937282728899, -67.62183590358129 3.839481716319995, -67.33756384954368 3.542342230641722, -67.30317318385345 3.31845408773718, -67.80993811712371 2.820655015469569, -67.44709204778631 2.600280869960869, -67.18129431829307 2.250638129074062, -66.87632585312258 1.253360500489336))",
        # Venezuela
        "POLYGON ((-60.73357418480372 5.200277207861901, -60.60117916527194 4.91809804933213, -60.96689327660154 4.536467596856639, -62.08542965355913 4.162123521334308, -62.80453304711671 4.006965033377952, -63.09319759789911 3.770571193858785, -63.88834286157416 4.020530096854571, -64.62865943058755 4.14848094320925, -64.81606401229402 4.056445217297423, -64.36849443221411 3.797210394705246, -64.40882788761792 3.126786200366624, -64.2699991522658 2.497005520025567, -63.42286739770512 2.411067613124175, -63.36878801131166 2.200899562993129, -64.08308549666609 1.91636912679408, -64.19930579289051 1.49285492594602, -64.61101192895987 1.328730576987042, -65.35471330428837 1.0952822941085, -65.54826738143757 0.7892544620760303, -66.32576514348496 0.7244522159820121, -66.87632585312258 1.253360500489336, -67.18129431829307 2.250638129074062, -67.44709204778631 2.600280869960869, -67.80993811712371 2.820655015469569, -67.30317318385345 3.31845408773718, -67.33756384954368 3.542342230641722, -67.62183590358129 3.839481716319995, -67.82301225449355 4.503937282728899, -67.74469662135522 5.221128648291668, -67.52153194850275 5.556870428891969, -67.34143958196557 6.095468044454023, -67.69508724635502 6.267318020040647, -68.26505245631823 6.153268133972475, -68.98531856960236 6.206804917826858, -69.38947994655712 6.099860541198836, -70.09331295437242 6.96037649172311, -70.67423356798152 7.087784735538719, -71.96017574734864 6.991614895043539, -72.19835242378188 7.340430813013683, -72.44448727078807 7.423784898300482, -72.47967892117885 7.632506008327354, -72.36090064155597 8.002638454617895, -72.43986223009796 8.405275376820029, -72.66049475776811 8.625287787302682, -72.78872982450039 9.085027167187334, -73.30495154488005 9.151999823437606, -73.02760413276957 9.736770331252444, -72.90528601753471 10.45034434655477, -72.61465776232521 10.82197540938178, -72.22757544624294 11.10870209395324, -71.97392167833829 11.60867157637712, -71.3315836249503 11.77628408451581, -71.36000566271082 11.53999359786121, -71.94704993354651 11.42328237553002, -71.62086829292019 10.96945994714279, -71.63306393094109 10.44649445234903, -72.07417395698451 9.865651353388373, -71.69564409044654 9.072263088411248, -71.26455929226773 9.137194525585983, -71.03999935574339 9.859992784052409, -71.35008378771079 10.21193512617621, -71.40062333849224 10.96896902103602, -70.15529883490652 11.37548167566004, -70.29384334988103 11.84682241459421, -69.94324459499683 12.1623070337361, -69.58430009629747 11.45961090743121, -68.88299923366445 11.44338450769156, -68.23327145045873 10.88574412682995, -68.19412655299763 10.55465322513592, -67.29624854192633 10.54586823164631, -66.227864142508 10.64862681725869, -65.65523759628175 10.20079885501732, -64.89045223657817 10.0772146671913, -64.32947872583374 10.38959870039568, -64.31800655786495 10.64141795495398, -63.07932247582873 10.7017243514386, -61.8809460109802 10.7156253117251, -62.73011898461641 10.42026866296091, -62.38851192895098 9.94820445397464, -61.58876746280194 9.873066921422264, -60.83059668643172 9.381339829948942, -60.67125240745973 8.580174261911878, -60.15009558779618 8.602756862823426, -59.75828487815919 8.367034816924047, -60.5505879380582 7.779602972846178, -60.63797278506377 7.414999904810855, -60.2956680975624 7.043911444522919, -60.54399919294099 6.856584377464883, -61.15933631045648 6.696077378766319, -61.13941504580795 6.234296779806144, -61.41030290388196 5.959068101419618, -60.73357418480372 5.200277207861901))",
        # Guyana
        "POLYGON ((-56.53938574891455 1.899522609866921, -56.78270423036083 1.863710842288654, -57.3358229233969 1.948537705895759, -57.66097103537737 1.682584947105639, -58.11344987652502 1.507195135907025, -58.42947709820596 1.463941962078721, -58.5400129868783 1.268088283692521, -59.03086157900265 1.317697658692722, -59.64604366722126 1.786893825686789, -59.71854570172675 2.24963043864436, -59.97452490908456 2.755232652188056, -59.81541317405787 3.606498521332085, -59.53803992373123 3.958802598481938, -59.76740576845872 4.423502915866607, -60.11100236676738 4.574966538914083, -59.98095862490489 5.014061184098139, -60.21368343773133 5.244486395687602, -60.73357418480372 5.200277207861901, -61.41030290388196 5.959068101419618, -61.13941504580795 6.234296779806144, -61.15933631045648 6.696077378766319, -60.54399919294099 6.856584377464883, -60.2956680975624 7.043911444522919, -60.63797278506377 7.414999904810855, -60.5505879380582 7.779602972846178, -59.75828487815919 8.367034816924047, -59.10168412945866 7.999201971870492, -58.48296220562806 7.347691351750697, -58.45487606467742 6.832787380394464, -58.07810319683738 6.809093736188643, -57.54221859397065 6.321268215353356, -57.14743648947689 5.973149929219161, -57.30724585633951 5.073566595882227, -57.91428890647214 4.812626451024414, -57.8602095200787 4.57680105226045, -58.04469438336068 4.060863552258382, -57.60156897645787 3.334654649260685, -57.28143347840971 3.333491929534119, -57.15009782573991 2.768926906745406, -56.53938574891455 1.899522609866921))",
        # Suriname
        "POLYGON ((-54.52475419779972 2.311848863123785, -55.09758744975514 2.523748073736613, -55.569755011606 2.421506252447131, -55.97332210958938 2.510363877773017, -56.0733418442903 2.220794989425499, -55.90560014507088 2.02199575439866, -55.99569800477175 1.817667141116601, -56.53938574891455 1.899522609866921, -57.15009782573991 2.768926906745406, -57.28143347840971 3.333491929534119, -57.60156897645787 3.334654649260685, -58.04469438336068 4.060863552258382, -57.8602095200787 4.57680105226045, -57.91428890647214 4.812626451024414, -57.30724585633951 5.073566595882227, -57.14743648947689 5.973149929219161, -55.9493184067898 5.772877915872002, -55.84177975119042 5.95312531170606, -55.03325029155177 6.025291449401664, -53.9580446030709 5.756548163267765, -54.47863298197923 4.896755682795586, -54.39954220235651 4.212611395683467, -54.00693050801901 3.620037746592558, -54.18172604024628 3.189779771330421, -54.2697051662232 2.732391669115046, -54.52475419779972 2.311848863123785))",
        # Ecuador
        "POLYGON ((-75.37322323271385 -0.1520317521204504, -75.23372270374195 -0.9114169246495294, -75.54499569365204 -1.56160979574588, -76.63539425322672 -2.608677666843818, -77.83790483265861 -3.003020521663103, -78.45068396677564 -3.873096612161376, -78.63989722361234 -4.547784112164074, -79.20528906931773 -4.959128513207389, -79.62497921417618 -4.454198093283495, -80.02890804718561 -4.346090996928893, -80.44224199087216 -4.425724379090674, -80.46929460317695 -4.059286797708999, -80.18401485870967 -3.821161797708044, -80.30256059438722 -3.404856459164713, -79.77029334178093 -2.65751189535964, -79.98655921092242 -2.220794366061014, -80.36878394236925 -2.685158786635788, -80.96776546906436 -2.246942640800704, -80.76480628123804 -1.965047702648533, -80.93365902375172 -1.057454522306358, -80.58337032746127 -0.9066626928786832, -80.39932471385376 -0.2837033016001413, -80.02089820018037 0.3603400740534682, -80.09060970734211 0.7684288598623965, -79.5427620103998 0.982937730305963, -78.85525875518871 1.380923773601822, -77.85506140817952 0.8099250349927729, -77.66861284047044 0.8258930525709616, -77.4249843004304 0.395686753741117, -76.5763797675494 0.256935533037435, -76.29231441924097 0.4160472680641192, -75.8014658271166 0.08480133707320192, -75.37322323271385 -0.1520317521204504))",
        # Paraguay
        "POLYGON ((-58.16639238140804 -20.17670094165368, -57.8706739976178 -20.73268767668195, -57.93715572776129 -22.09017587655717, -56.8815095689029 -22.28215382252148, -56.47331743022939 -22.08630014413528, -55.79795813660691 -22.35692962004782, -55.61068274598114 -22.65561939869485, -55.51763932963964 -23.57199757252664, -55.40074723979542 -23.9569353166688, -55.02790178080955 -24.00127369557523, -54.65283423523513 -23.83957813893396, -54.29295956075452 -24.02101409271073, -54.29347632507745 -24.57079965586396, -54.42894609233059 -25.16218474701217, -54.62529069682358 -25.73925546641551, -54.78879492859505 -26.62178557709613, -55.69584550639816 -27.38783700939086, -56.486701626193 -27.54849903738629, -57.60975969097614 -27.39589853282839, -58.61817359071975 -27.1237187639471, -57.63366004091113 -25.60365650808164, -57.77721716981794 -25.16233977630904, -58.80712846539498 -24.77145924245331, -60.02896603050403 -24.03279631927327, -60.84656470400991 -23.88071257903829, -62.68505713565789 -22.24902922942239, -62.29117936872922 -21.05163461678739, -62.2659612697708 -20.51373463306128, -61.78632646345377 -19.63373666756296, -60.04356462262649 -19.34274667732743, -59.11504248720611 -19.3569060197754, -58.18347144228051 -19.86839934660036, -58.16639238140804 -20.17670094165368))",
    ],
}

cities = ['Buenos Aires', 'Brasilia', 'Santiago',  'Bogota', 'Caracas', 'Sao Paulo', 'Bridgetown']
latitudes = [-34.58, -15.78, -33.45, 4.60, 10.48, -23.55, 13.1]
longitudes = [-58.66, -47.91, -70.66, -74.08, -66.86, -46.63, -59.62]
data = {'City': cities,  'Latitude': latitudes, 'Longitude': longitudes}
cities = starepandas.STAREDataFrame(data)
stare = starepandas.sids_from_xy(cities.Longitude, cities.Latitude, level=26)
cities.set_sids(stare, inplace=True)

# countries = geopandas.read_file(geopandas.datasets.get_path("naturalearth_lowres"))
samerica = countries[countries.continent == 'South America']
stare = starepandas.sids_from_gdf(samerica, level=6, force_ccw=True)
samerica = starepandas.STAREDataFrame(samerica, sids=stare)


def join():
    joined = starepandas.stare_join(samerica, cities, how='left')
    column_names = ['pop_est', 'continent', 'name', 'iso_a3', 'gdp_md_est', 'geometry', 'stare_left', 'trixels_left',
                    'key_right', 'City', 'Latitude', 'Longitude', 'stare_right', 'trixels_right']
    assert list(joined.columns) == column_names
