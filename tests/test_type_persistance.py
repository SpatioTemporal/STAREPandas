import geopandas
import starepandas
from shapely.wkt import loads

countries = {
    "pop_est": [
        144373535.0, 5347896.0, 67059887.0, 10285453.0, 9466856.0,
        361313.0
    ],
    "continent": [
        "Europe", "Europe", "Europe", "Europe", "Europe",
        "Europe"
    ],
    "name": [
        "Russia", "Norway", "France", "Sweden", "Belarus",
        "Iceland"
    ],
    "iso_a3": [
        "RUS", "NOR", "FRA", "SWE", "BLR",
        "ISL"
    ],
    "gdp_md_est": [
        1699876, 403336, 2715518, 530883, 63080,
        24188
    ],
    "geometry": [
        # Russia
        "MULTIPOLYGON (((180.0000000000001 71.51571433642829, 180.0000000000001 70.83219920854673, 178.903425 70.78114000000001, 178.7253 71.0988, 180.0000000000001 71.51571433642829)), ((48.64541000000008 45.8062900000001, 47.67590999999999 45.64149000000015, 46.68201000000005 44.6092000000001, 47.59093999999999 43.66016000000008, 47.49252000000007 42.98658000000012, 48.58437000000015 41.80888000000004, 48.58435339611342 41.80886879162067, 47.98728315612598 41.40581920019423, 47.81566572448463 41.15141612402135, 47.37331546406623 41.2197323675112, 46.68607059101661 41.82713715266988, 46.40495079934882 41.86067515722731, 45.77640000000002 42.09244000000018, 45.47027916848572 42.50278066666998, 44.53762291848199 42.71199270280363, 43.93121000000014 42.55496000000011, 43.75599000000011 42.74083000000007, 42.39440000000013 43.22030000000007, 40.92219000000011 43.38215000000014, 40.07696495947977 43.55310415300232, 39.95500857927092 43.43499766699922, 38.68000000000001 44.28000000000009, 37.53912000000003 44.65721000000002, 36.6754600000001 45.24469000000011, 37.4031700000001 45.40451000000013, 38.23295000000002 46.24087000000003, 37.67372 46.63657000000001, 39.14767000000012 47.04475000000014, 39.12120000000004 47.26336000000009, 38.22353803889933 47.10218984637595, 38.25511233902978 47.54640045835691, 38.77057000000008 47.82562000000019, 39.73827762223885 47.89893707945197, 39.89562000000018 48.23241000000007, 39.67464999999999 48.78382000000016, 40.08078901546941 49.30742991799934, 40.06904000000014 49.60104999999999, 38.59498823421342 49.9264619004237, 38.01063113785693 49.9156615260747, 37.39345950699516 50.38395335550365, 36.62616784032542 50.22559092874513, 35.35611616388798 50.57719737405904, 35.37790999999999 50.7739400000001, 35.02218305841791 51.2075723333715, 34.22481570815427 51.25599315042888, 34.14197838719053 51.56641347920635, 34.39173058445709 51.76888174092591, 33.75269982273579 52.3350745713318, 32.71576053236709 52.23846548116211, 32.41205813978769 52.28869497334978, 32.15944000000013 52.06125000000014, 31.78599244755525 52.1016775699397, 31.78597000000008 52.1016800000001, 31.54001834486226 52.74205231384636, 31.30520063652801 53.07399587667321, 31.49763999999999 53.16743000000014, 32.30451948418823 53.13272614197291, 32.69364301934604 53.35142080343218, 32.40559858575116 53.61804535584204, 31.73127282077451 53.79402944601202, 31.79142418796224 53.97463857687212, 31.38447228366374 54.15705638286238, 30.75753380709872 54.81177094178432, 30.97183597181314 55.08154775656404, 30.87390913262001 55.55097646750341, 29.89629438652236 55.78946320253041, 29.37157189303067 55.67009064393618, 29.22951338066031 55.91834422466636, 28.17670942557794 56.16912995057879, 27.85528201672253 56.75932648378429, 27.77001590344093 57.24425812441123, 27.28818484875151 57.47452830670383, 27.71668582531572 57.79189911562436, 27.42015000000015 58.72457000000014, 28.13169925305175 59.30082510033093, 27.98112000000003 59.47537000000011, 27.98112685700099 59.47537333432527, 29.11770000000001 60.02805000000012, 28.07000192152567 60.50351912796823, 28.07000000000005 60.50352000000009, 30.21110721204445 61.78002777774969, 31.13999108249089 62.35769277612441, 31.51609215671112 62.86768748641289, 30.03587243014272 63.55281362573855, 30.44468468600371 64.20445343693909, 29.54442955904699 64.94867157659048, 30.21765 65.80598000000001, 29.05458865735233 66.94428620062206, 29.97742638522061 67.69829702419275, 28.44594363781866 68.36461294216404, 28.59192955904319 69.06477692328666, 29.39955000000003 69.15692000000013, 31.10104220259763 69.55810108805622, 31.10108000000008 69.55811000000011, 32.13272000000018 69.90595000000019, 33.77547000000004 69.30142000000012, 36.51396 69.06342000000006, 40.29234000000014 67.93240000000003, 41.05987000000005 67.45713000000012, 41.1259500000001 66.79158000000007, 40.01583000000005 66.26618000000013, 38.38294999999999 65.99953000000011, 33.91871000000015 66.75961000000001, 33.18444000000005 66.63252999999997, 34.81477000000012 65.90015000000017, 34.87857425307874 65.43621287704821, 34.94391000000007 64.41437000000019, 36.23129 64.10945000000004, 37.01273000000009 63.84983000000011, 37.14197000000019 64.33471000000009, 36.53957903508979 64.76446000000004, 37.17604000000006 65.14322000000016, 39.59345000000002 64.5207900000002, 40.43560000000008 64.76446000000004, 39.76260000000019 65.49682000000001, 42.09309000000013 66.47623000000004, 43.01604000000009 66.41858000000013, 43.94975000000011 66.06908000000004, 44.53226000000001 66.75634000000014, 43.69839000000007 67.35245000000003, 44.18795000000017 67.95051000000012, 43.45282000000003 68.57078999999999, 46.25000000000011 68.25, 46.82134000000008 67.68997000000007, 45.55517000000003 67.56652000000003, 45.56202000000013 67.01005000000015, 46.34915000000012 66.6676700000001, 47.89416000000017 66.8845500000001, 48.13876000000005 67.52238000000006, 50.22766000000013 67.99867000000017, 53.71743000000015 68.85738000000015, 54.47171000000009 68.80815000000001, 53.48582000000016 68.20130999999998, 54.72627999999997 68.09701999999999, 55.44268000000011 68.43866000000008, 57.31702000000007 68.4662800000001, 58.80200000000013 68.88081999999997, 59.94142000000011 68.27844000000005, 61.07784000000021 68.94069000000007, 60.02999999999997 69.5200000000001, 60.55000000000001 69.85000000000002, 63.50400000000013 69.54739000000006, 64.88811500000003 69.23483500000009, 68.51216000000016 68.09233000000012, 69.18068000000011 68.61563000000012, 68.16444000000007 69.14436000000006, 68.13522 69.35649000000012, 66.93008000000015 69.45461000000012, 67.25976000000009 69.92873000000009, 66.72492000000017 70.70889000000017, 66.69466000000006 71.02897000000019, 68.54006000000004 71.93450000000018, 69.19636000000003 72.84336000000019, 69.94 73.04000000000008, 72.58754000000005 72.77629000000013, 72.79603000000003 72.22005999999999, 71.84811000000008 71.4089800000001, 72.47010999999998 71.09019000000006, 72.79188000000005 70.39114000000001, 72.56470000000013 69.02085, 73.66786999999999 68.40789999999998, 73.23870000000005 67.74040000000002, 71.28000000000009 66.32000000000011, 72.42301000000009 66.17267000000021, 72.82076999999998 66.53267000000005, 73.92099000000013 66.78946000000013, 74.18651000000011 67.28429, 75.05200000000008 67.76047000000011, 74.46926000000013 68.32899000000009, 74.9358400000001 68.98918000000009, 73.84235999999999 69.07146000000006, 73.60187000000019 69.62763000000001, 74.39980000000003 70.63175000000001, 73.10109999999997 71.4471700000002, 74.89082000000019 72.12119000000013, 74.65926000000007 72.83227000000005, 75.1580100000001 72.85497000000015, 75.68351000000013 72.30056000000013, 75.28898000000009 71.3355600000001, 76.35911000000004 71.15287000000018, 75.90313000000015 71.87401000000006, 77.57665000000009 72.26717000000002, 79.65202000000011 72.32011, 81.50000000000006 71.75000000000006, 80.6107100000001 72.58285000000012, 80.51109000000002 73.64819999999997, 82.25000000000006 73.85000000000014, 84.65526 73.80591000000021, 86.82230000000015 73.93688000000003, 86.00956000000002 74.45967000000019, 87.16682000000014 75.11643000000004, 88.31571000000008 75.14393000000007, 90.26000000000005 75.64000000000004, 92.90057999999999 75.7733300000001, 93.23421000000008 76.04720000000009, 95.86000000000018 76.1400000000001, 96.67821000000009 75.91548, 98.92254000000014 76.44689, 100.7596700000001 76.43028000000004, 101.03532 76.86189000000007, 101.9908400000001 77.28754000000015, 104.3516000000001 77.69792000000007, 106.0666400000002 77.37389000000007, 104.7050000000002 77.12740000000008, 106.9701300000001 76.97419000000008, 107.2400000000001 76.48000000000002, 108.1538000000001 76.7233500000001, 111.0772600000002 76.71000000000004, 113.33151 76.22224, 114.13417 75.84764000000001, 113.88539 75.32779000000016, 112.77918 75.03186000000011, 110.1512500000001 74.47673000000003, 109.4 74.18000000000006, 110.64 74.04000000000002, 112.11919 73.78774000000016, 113.0195400000002 73.97693000000015, 113.5295800000002 73.33505000000014, 113.96881 73.59488000000005, 115.56782 73.75285000000008, 118.7763300000001 73.58771999999999, 119.02 73.12000000000006, 123.2006600000001 72.97122000000007, 123.2577700000002 73.73503000000005, 125.3800000000001 73.56000000000006, 126.97644 73.56549000000012, 128.59126 73.03871000000009, 129.05157 72.39872000000008, 128.46 71.98000000000002, 129.7159900000001 71.19304000000011, 131.2885800000003 70.78699000000012, 132.2535000000001 71.83630000000011, 133.8576600000002 71.3864200000001, 135.56193 71.65525000000014, 137.49755 71.34763000000009, 138.2340900000002 71.62803000000002, 139.8698300000001 71.48783000000014, 139.14791 72.41619000000014, 140.46817 72.84941000000015, 149.5 72.20000000000005, 150.3511800000001 71.60643000000005, 152.9689000000002 70.84222000000005, 157.00688 71.03141000000005, 158.99779 70.86671999999999, 159.8303100000002 70.45324000000005, 159.70866 69.72198000000003, 160.9405300000003 69.4372800000001, 162.27907 69.64204000000001, 164.0524800000001 69.66822999999999, 165.9403700000001 69.47199000000001, 167.8356699999999 69.58269000000013, 169.5776300000001 68.69380000000007, 170.8168800000002 69.01362999999998, 170.0082000000001 69.65276000000006, 170.4534500000002 70.09703000000007, 173.6439100000001 69.81743000000006, 175.7240300000002 69.87725000000017, 178.6 69.40000000000003, 180 68.96363636363651, 180 64.97970870219848, 179.99281 64.97433000000001, 178.7072000000003 64.53493000000003, 177.41128 64.60821000000004, 178.3130000000001 64.07593000000003, 178.9082500000002 63.25197000000009, 179.3703399999999 62.98262000000011, 179.48636 62.56894, 179.22825 62.30410000000018, 177.3643000000001 62.52190000000007, 174.5692900000003 61.76915000000002, 173.6801300000001 61.6526100000001, 172.15 60.94999999999999, 170.6985000000001 60.33618000000013, 170.3308500000003 59.88177000000007, 168.90046 60.57355000000007, 166.2949800000002 59.78855000000016, 165.8400000000001 60.16000000000003, 164.8767399999999 59.73160000000001, 163.5392900000001 59.86871000000002, 163.2171100000002 59.21101000000004, 162.01733 58.24328000000003, 162.05297 57.83911999999998, 163.19191 57.6150300000001, 163.0579400000001 56.15924000000012, 162.1295800000001 56.12219000000005, 161.70146 55.28568000000018, 162.1174900000001 54.85514000000001, 160.3687700000003 54.34433000000007, 160.0217300000002 53.20257000000009, 158.5309400000001 52.95868000000019, 158.23118 51.94269000000003, 156.7897900000003 51.01105000000007, 156.4200000000001 51.70000000000005, 155.99182 53.15895, 155.43366 55.38103000000012, 155.9144200000003 56.76792000000017, 156.75815 57.36470000000003, 156.8103500000001 57.83204000000001, 158.3643300000001 58.05575000000005, 160.1506400000001 59.31477000000007, 161.87204 60.34300000000007, 163.6696899999999 61.1409000000001, 164.47355 62.55061000000001, 163.2584200000001 62.46627000000012, 162.65791 61.64250000000004, 160.12148 60.54423000000008, 159.30232 61.7739600000001, 156.72068 61.43442000000005, 154.2180600000003 59.75818000000015, 155.04375 59.14495000000005, 152.81185 58.88385000000005, 151.2657300000002 58.78089, 151.33815 59.50396000000006, 149.78371 59.65573000000018, 148.54481 59.16448000000003, 145.48722 59.33637000000004, 142.1978200000001 59.03998000000013, 138.9584800000002 57.08805000000007, 135.12619 54.72959000000009, 136.70171 54.60355000000015, 137.1934200000001 53.97732000000002, 138.1647 53.7550100000002, 138.80463 54.25455000000005, 139.90151 54.18968000000012, 141.34531 53.08957000000015, 141.37923 52.23877000000005, 140.5974200000002 51.2396700000001, 140.5130799999999 50.04553000000016, 140.0619300000002 48.44671000000011, 138.5547200000002 46.99964999999997, 138.21971 46.30795000000001, 136.8623200000001 45.14350000000013, 135.5153500000001 43.98900000000009, 134.8693900000002 43.39821000000006, 133.5368700000002 42.8114700000001, 132.9062700000001 42.79849000000013, 132.2780700000002 43.28456000000011, 130.9358700000001 42.55274000000009, 130.7800048535851 42.22001036108258, 130.7800036600468 42.22000781320322, 130.78 42.22000000000014, 130.7799923165783 42.22000960427719, 130.6400000000001 42.39500000000004, 130.6399997069095 42.39502427522179, 130.6338664084097 42.90301463477053, 131.1446879416149 42.92998973242689, 131.2885551291155 44.11151968034828, 131.0251900000002 44.96796000000006, 131.8834542176595 45.32116160743652, 133.0971200000001 45.14409000000006, 133.7696439963129 46.11692698829901, 134.1123500000001 47.21248000000008, 134.50081 47.57845000000009, 135.0263114767866 48.47822988544387, 133.3735958192279 48.18344167743487, 132.50669 47.78896000000003, 130.9872600000001 47.79013000000003, 130.5822933289824 48.72968740497614, 129.3978178244204 49.44060008401544, 127.6574000000003 49.76027000000011, 127.2874556824848 50.73979726826548, 126.9391565288377 51.35389415140592, 126.564399041857 51.7842554795327, 125.9463489116462 52.79279857035698, 125.0682112977104 53.16104482686886, 123.57147 53.45880000000005, 122.2457479187928 53.4317259792137, 121.0030847514702 53.25140106873119, 120.1770886577168 52.75388621684124, 120.725789015792 52.51622630473094, 120.7382 51.96411000000006, 120.1820800000002 51.64355000000012, 119.27939 50.58292, 119.2884607280258 50.142882798862, 117.8792444194264 49.51098338479697, 116.6788008972861 49.8885313991214, 115.4856954285314 49.80517731383475, 114.9621098165502 50.14024730081513, 114.3624564962353 50.24830272073741, 112.8977396993544 49.54356537535699, 111.5812309102866 49.37796824807769, 110.6620105326788 49.13012807880585, 109.4024491719966 49.29296051695763, 108.4751672709513 49.28254771585074, 107.8681758972509 49.79370514586581, 106.8888041524553 50.27429596618032, 105.8865914245868 50.40601919209222, 104.62158 50.27532000000019, 103.6765454447602 50.08996613219512, 102.2558900000001 50.51056000000011, 102.06521 51.25991000000005, 100.8894804219626 51.51685578063832, 99.98173221232354 51.63400625264399, 98.86149051310034 52.04736603454669, 97.82573978067431 51.01099518493318, 98.23176150919156 50.42240062112874, 97.25976000000014 49.72605000000004, 95.8140200000002 49.97746000000012, 94.81594933469873 50.01343333597085, 94.14756635943559 50.48053660745717, 93.10421000000002 50.49529000000001, 92.23471154171968 50.80217072204172, 90.71366743364068 50.33181183532109, 88.80556684769552 49.47052073831242, 87.75126427607671 49.29719798440549, 87.35997033076265 49.21498078062912, 86.82935672398963 49.82667470966817, 85.54126997268247 49.69285858824816, 85.11555952346203 50.11730296487764, 84.41637739455308 50.31139964456582, 83.93511478061885 50.88924551045358, 83.38300377801238 51.06918284769392, 81.94598554883993 50.81219594990637, 80.56844689323549 51.38833649352847, 80.03555952344169 50.86475088154725, 77.80091556184425 53.40441498474758, 76.52517947785475 54.17700348572714, 76.89110029491343 54.49052440044193, 74.38482000000016 53.54685000000012, 73.42567874542044 53.48981028910976, 73.5085160663844 54.0356167669766, 72.22415001820218 54.37665538188674, 71.18013105660941 54.13328522400826, 70.86526655465514 55.16973358827011, 69.06816694527288 55.38525014914353, 68.16910037625883 54.97039175070432, 65.66687000000002 54.60125000000011, 65.17853356309593 54.35422781027211, 61.43660000000017 54.00625000000002, 60.97806644068316 53.66499339457914, 61.69998619980061 52.97999644633427, 60.73999311711458 52.71998647725775, 60.92726850774028 52.44754832621504, 59.96753380721555 51.9604204372157, 61.58800337102417 51.27265879984321, 61.33742435084093 50.79907013610426, 59.93280724471549 50.84219411885186, 59.64228234237061 50.54544220641571, 58.36332000000004 51.06364000000002, 56.77798000000013 51.0435500000001, 55.71694000000002 50.62171000000018, 54.53287845237622 51.02623973245932, 52.32872358583097 51.71865224873812, 50.76664839051216 51.6927623561599, 48.70238162618102 50.60512848571284, 48.57784142435753 49.87475962991567, 47.54948042174931 50.45469839131113, 46.75159630716274 49.35600576435377, 47.04367150247651 49.15203888609761, 46.46644575377627 48.39415233010493, 47.31524000000013 47.7158500000001, 48.05725000000001 47.74377000000004, 48.69473351420174 47.07562816017793, 48.59325000000018 46.56104000000005, 49.10116000000011 46.39933000000013, 48.64541000000008 45.8062900000001)), ((95.94089500000001 81.2504, 97.88385 80.74697500000002, 100.186655 79.780135, 99.93976000000001 78.88094, 97.75794 78.75619999999999, 94.97259 79.04474500000001, 93.31288000000001 79.4265, 92.5454 80.14379000000001, 91.18107000000002 80.34146000000001, 93.77766000000001 81.02460000000001, 95.94089500000001 81.2504)), ((105.37243 78.71334, 105.07547 78.30689, 99.43814 77.92100000000001, 101.2649 79.23399000000001, 102.08635 79.34641000000001, 102.837815 79.28129, 105.37243 78.71334)), ((141.471615 76.09289, 145.086285 75.562625, 144.3 74.82000000000001, 140.61381 74.84768, 138.95544 74.61148, 136.97439 75.26167000000001, 137.51176 75.94917, 138.831075 76.13676000000001, 141.471615 76.09289)), ((150.73167 75.08405999999999, 149.575925 74.68892, 147.977465 74.778355, 146.11919 75.17298, 146.358485 75.49682, 148.22223 75.345845, 150.73167 75.08405999999999)), ((140.81171 73.76506000000001, 142.06207 73.85758, 143.48283 73.47525, 143.60385 73.21244, 142.08763 73.20544, 140.038155 73.31692000000001, 139.86312 73.36983000000001, 140.81171 73.76506000000001)), ((46.79913862487123 80.77191762971368, 48.31847741068461 80.78400991486998, 48.52280602396667 80.51456899690017, 49.09718956889085 80.7539859077084, 50.03976769389462 80.91888540315178, 51.52293297710366 80.69972565380193, 51.13618655783128 80.54728017854093, 49.79368452332071 80.4154277615482, 48.89441124857755 80.33956675894375, 48.75493655782177 80.17546824820089, 47.58611901224418 80.01018117951533, 46.50282596210963 80.2472468126543, 47.07245527526294 80.55942414012951, 44.84695804218114 80.58980988231714, 46.79913862487123 80.77191762971368)), ((20.89224450041863 54.31252492941253, 19.6606400896064 54.42608388937393, 19.88848147958129 54.86616038677151, 21.26844892750347 55.19048167583531, 22.31572350433058 55.01529857036586, 22.75776370615526 54.85657440858138, 22.65105187347254 54.58274099386674, 22.73109866709265 54.32753693299333, 20.89224450041863 54.31252492941253)), ((55.90245893740766 74.62748647734536, 55.63193281435969 75.08141225859718, 57.86864383324885 75.60939036732326, 61.17004438664748 76.25188345000812, 64.49836836127017 76.43905548776927, 66.21097700385513 76.80978221303117, 68.1570597675348 76.93969676381293, 68.85221113472508 76.5448113064546, 68.1805725442276 76.23364166940907, 64.63732628770302 75.73775462513625, 61.58350752141476 75.26088450794684, 58.47708214705335 74.30905630156285, 56.98678551618803 73.33304352486623, 55.41933597191093 72.37126760526603, 55.62283776227633 71.54059479439032, 57.53569257999231 70.72046397570212, 56.94497928246388 70.63274323188666, 53.67737511578417 70.76265778266846, 53.41201663596539 71.20666168892022, 51.60189456564567 71.47475901965045, 51.45575361512422 72.01488108996513, 52.47827518088354 72.22944163684097, 52.44416873557088 72.77473135038481, 54.42761355979758 73.6275475124976, 53.50828982932515 73.7498139513002, 55.90245893740766 74.62748647734536)), ((143.2608476096321 52.74076040303906, 143.2352677756476 51.75666026468876, 143.6480074403628 50.7476004095415, 144.6541475770856 48.97639069273754, 143.1739278505172 49.30655141865032, 142.5586682476501 47.86157501890495, 143.533492466404 46.83672801369252, 143.5052771343726 46.13790761980952, 142.7477006369738 46.74076487892651, 142.0920300640545 45.96675527605883, 141.906925083585 46.80592886004656, 142.0184428244709 47.78013296161296, 141.904444614835 48.85918854429957, 142.1358000022057 49.61516307229739, 142.1799833518153 50.9523424342819, 141.59407596249 51.9354348822025, 141.6825460145737 53.3019664577288, 142.6069340354107 53.76214508728793, 142.2097489768154 54.22547597921687, 142.654786411713 54.36588084575389, 142.9146155132765 53.70457754171478, 143.2608476096321 52.74076040303906)), ((-175.01425 66.58435, -174.33983 66.33556, -174.57182 67.06219, -171.85731 66.91308000000001, -169.89958 65.97723999999999, -170.89107 65.54138999999999, -172.53025 65.43791, -172.555 64.46079, -172.95533 64.25269, -173.89184 64.2826, -174.65392 64.63125000000001, -175.98353 64.92288000000001, -176.20716 65.35667000000001, -177.22266 65.52024, -178.35993 65.39052000000001, -178.90332 65.74044000000001, -178.68611 66.11211, -179.88377 65.87456, -179.43268 65.40411, -180 64.97970870219839, -180 68.96363636363635, -177.55 68.2, -174.92825 67.20589000000001, -175.01425 66.58435)), ((-180 70.83219920854673, -180 71.51571433642827, -179.871875 71.55762000000001, -179.02433 71.55553, -177.577945 71.26948, -177.663575 71.13277000000001, -178.69378 70.89302000000001, -180 70.83219920854673)))",
        # Norway
        "MULTIPOLYGON (((15.14282 79.67431000000001, 15.52255 80.01608, 16.99085 80.05086, 18.25183 79.70175, 21.54383 78.95611, 19.02737 78.5626, 18.47172 77.82669, 17.59441 77.63796000000001, 17.1182 76.80941, 15.91315 76.77045, 13.76259 77.38035000000001, 14.66956 77.73565000000001, 13.1706 78.02493, 11.22231 78.8693, 10.44453 79.65239, 13.17077 80.01046000000001, 13.71852 79.66039000000001, 15.14282 79.67431000000001)), ((31.10104220259763 69.55810108805622, 29.39955000000003 69.15692000000013, 28.59192955904319 69.06477692328666, 29.01557295097197 69.76649119737799, 27.73229210786786 70.16419302029625, 26.17962202322624 69.82529897732614, 25.68921268077636 69.09211375596904, 24.73567915212672 68.64955678982146, 23.66204959483076 68.89124746365054, 22.35623782724741 68.84174144151491, 21.24493615081067 69.37044302029308, 20.64559288908953 69.10624726020087, 20.02526899585789 69.0651386583127, 19.87855960458126 68.40719432237258, 17.99386844246433 68.56739126247736, 17.72918175626535 68.01055186631628, 16.76887861498548 68.0139366726314, 16.10871219245678 67.30245555283689, 15.108411492583 66.19386688909547, 13.55568973150909 64.78702769638151, 13.9199052263022 64.44542064071608, 13.57191613124871 64.04911408146971, 12.57993533697393 64.06621898055833, 11.93056928879423 63.12831757267698, 11.99206424322156 61.80036245385655, 12.63114668137518 61.29357168237014, 12.3003658382749 60.11793284773003, 11.46827192551115 59.43239329694604, 11.02736860519687 58.85614940045936, 10.35655683761607 59.46980703392536, 8.382000359743586 58.31328847923321, 7.048748406613271 58.07888418235729, 5.665835402050419 58.5881554225937, 5.308234490590678 59.66323191999383, 4.992078077828978 61.97099803328432, 5.912900424837886 62.61447296818272, 8.553411085655739 63.45400828719648, 10.52770918136676 64.4860383164975, 12.35834679530637 65.87972585719318, 14.7611458675816 67.81064158799516, 16.43592736172894 68.56320547146173, 19.18402835457846 69.81744415961778, 21.37841637542058 70.2551693793461, 23.02374230316153 70.2020718451662, 24.54654340993847 71.03049673123722, 26.37004967622181 70.98626170519539, 28.16554731620294 71.18547435168055, 31.29341840996545 70.4537877468599, 30.00543501152279 70.18625885688489, 31.10104220259763 69.55810108805622)), ((27.40750573091345 80.05640574820042, 25.92465050629815 79.51783397085451, 23.02446577321362 79.40001170522903, 20.07518842945183 79.56682322866722, 19.89726647307091 79.84236196564747, 18.46226362475787 79.85988027619443, 17.36801517097746 80.31889618602698, 20.45599205901064 80.59815562613225, 21.9079447771154 80.35767934846204, 22.91925255706738 80.65714427359343, 25.44762535981187 80.40734039989452, 27.40750573091345 80.05640574820042)), ((24.72412 77.85384999999999, 22.49032 77.44493, 20.72601 77.67704000000001, 21.41611 77.93504, 20.8119 78.25463000000001, 22.88426 78.45494000000001, 23.28134 78.07953999999999, 24.72412 77.85384999999999)))",
        # France
        "MULTIPOLYGON (((-51.65779741067889 4.156232408053029, -52.24933753112396 3.241094468596245, -52.55642473001842 2.504705308437053, -52.93965715189496 2.124857692875636, -53.41846513529531 2.053389187015981, -53.55483924011354 2.334896551925951, -53.77852067728892 2.376702785650082, -54.08806250671725 2.105556545414629, -54.52475419779972 2.311848863123785, -54.2697051662232 2.732391669115046, -54.18172604024628 3.189779771330421, -54.00693050801901 3.620037746592558, -54.39954220235651 4.212611395683467, -54.47863298197923 4.896755682795586, -53.9580446030709 5.756548163267765, -53.61845292826484 5.646529038918374, -52.88214128275409 5.409850979021584, -51.8233428615259 4.565768133966131, -51.65779741067889 4.156232408053029)), ((6.186320428094177 49.46380280211451, 6.658229607783568 49.20195831969157, 8.099278598674744 49.01778351500333, 7.593676385131062 48.33301911070372, 7.466759067422231 47.62058197691181, 7.192202182655507 47.44976552997102, 6.736571079138059 47.54180125588285, 6.768713820023606 47.2877082383037, 6.037388950229001 46.72577871356187, 6.022609490593538 46.27298981382047, 6.500099724970426 46.42967275652944, 6.843592970414505 45.99114655210061, 6.802355177445605 45.70857982032864, 7.096652459347837 45.33309886329589, 6.749955275101655 45.02851797136758, 7.007562290076635 44.25476675066136, 7.549596388386107 44.12790110938481, 7.435184767291872 43.69384491634922, 6.52924523278304 43.12889232031831, 4.556962517931424 43.3996509873116, 3.100410597352663 43.07520050716705, 2.985998976258458 42.47301504166986, 1.826793247087153 42.34338471126569, 0.7015906103638941 42.79573436133261, 0.3380469091905809 42.57954600683955, -1.502770961910528 43.03401439063043, -1.901351284177764 43.42280202897834, -1.384225226232985 44.02261037859012, -1.193797573237418 46.01491771095486, -2.225724249673846 47.06436269793822, -2.963276129559603 47.57032664650795, -4.491554938159481 47.95495433205637, -4.592349819344776 48.68416046812699, -3.295813971357802 48.90169240985963, -1.616510789384961 48.64442129169454, -1.933494025063311 49.77634186461574, -0.98946895995536 49.34737580016091, 1.338761020522696 50.12717316344526, 1.6390010921385 50.9466063502975, 2.513573032246143 51.14850617126183, 2.658422071960274 50.79684804951575, 3.123251580425688 50.78036326761455, 3.588184441755658 50.37899241800356, 4.286022983425084 49.90749664977255, 4.799221632515724 49.98537303323637, 5.674051954784829 49.5294835475575, 5.897759230176348 49.44266714130711, 6.186320428094177 49.46380280211451)), ((8.746009148807559 42.62812185319392, 9.390000848028876 43.00998484961471, 9.560016310269134 42.15249197037952, 9.229752231491773 41.38000682226446, 8.775723097375362 41.58361196549443, 8.544212680707773 42.25651662858306, 8.746009148807559 42.62812185319392)))",
        # Sweden
        "POLYGON ((11.02736860519687 58.85614940045936, 11.46827192551115 59.43239329694604, 12.3003658382749 60.11793284773003, 12.63114668137518 61.29357168237014, 11.99206424322156 61.80036245385655, 11.93056928879423 63.12831757267698, 12.57993533697393 64.06621898055833, 13.57191613124871 64.04911408146971, 13.9199052263022 64.44542064071608, 13.55568973150909 64.78702769638151, 15.108411492583 66.19386688909547, 16.10871219245678 67.30245555283689, 16.76887861498548 68.0139366726314, 17.72918175626535 68.01055186631628, 17.99386844246433 68.56739126247736, 19.87855960458126 68.40719432237258, 20.02526899585789 69.0651386583127, 20.64559288908953 69.10624726020087, 21.97853478362612 68.6168456081807, 23.53947309743444 67.93600861273525, 23.56587975433558 66.39605093043743, 23.9033785336338 66.00692739527962, 22.18317345550193 65.72374054632017, 21.21351687997722 65.02600535751527, 21.36963138193096 64.41358795842429, 19.77887576669022 63.60955434839504, 17.84777916837521 62.74940013289681, 17.11955488451812 61.34116567651097, 17.83134606290639 60.63658336042741, 18.78772179533209 60.0819143744226, 17.86922488777634 58.9537661810587, 16.82918501147009 58.71982697207339, 16.44770958829147 57.04111806907189, 15.87978559740378 56.10430186626866, 14.66668134935207 56.20088511822217, 14.10072106289146 55.40778107362265, 12.94291059739206 55.36173737245058, 12.62510053879703 56.30708018658197, 11.78794233566867 57.44181712506307, 11.02736860519687 58.85614940045936))",
        # Belarus
        "POLYGON ((28.17670942557794 56.16912995057879, 29.22951338066031 55.91834422466636, 29.37157189303067 55.67009064393618, 29.89629438652236 55.78946320253041, 30.87390913262001 55.55097646750341, 30.97183597181314 55.08154775656404, 30.75753380709872 54.81177094178432, 31.38447228366374 54.15705638286238, 31.79142418796224 53.97463857687212, 31.73127282077451 53.79402944601202, 32.40559858575116 53.61804535584204, 32.69364301934604 53.35142080343218, 32.30451948418823 53.13272614197291, 31.49763999999999 53.16743000000014, 31.30520063652801 53.07399587667321, 31.54001834486226 52.74205231384636, 31.78597000000008 52.1016800000001, 31.78599244755525 52.1016775699397, 30.92754926933898 52.04235342061439, 30.61945438001482 51.82280609802245, 30.55511722181146 51.31950348571566, 30.1573637224609 51.41613841410147, 29.25493818534784 51.36823436136689, 28.99283532076353 51.60204437927148, 28.61761274589225 51.42771393493484, 28.24161502453657 51.57222707783907, 27.45406619640841 51.5923033717844, 26.33795861176856 51.83228872334797, 25.32778771332701 51.91065603291855, 24.55310631683952 51.88846100524918, 24.00507775238418 51.61744395609441, 23.52707075368437 51.57845408793031, 23.50800215016869 52.02364655212473, 23.19949384938619 52.48697744405367, 23.79919884613338 52.69109935160657, 23.80493493011778 53.08973135030607, 23.527535841575 53.47012156840655, 23.48412763844985 53.91249766704114, 24.45068362803704 53.90570221619475, 25.53635379405699 54.28242340760253, 25.7684326514798 54.84696259217509, 26.58827924979039 55.16717560487167, 26.49433149588376 55.61510691997763, 27.10245975109453 55.78331370708769, 28.17670942557794 56.16912995057879))",
        # Iceland
        "POLYGON ((-14.50869544112923 66.45589223903143, -14.73963741704161 65.8087482774403, -13.60973222497981 65.12667104761987, -14.9098337467949 64.36408193628868, -17.79443803554342 63.67874909123385, -18.65624589687499 63.49638296167582, -19.97275468594276 63.64363495549153, -22.76297197111016 63.96017894149539, -21.77848425951768 64.40211579045551, -23.95504391121911 64.8911298692335, -22.18440263517036 65.08496816676031, -22.22742326505333 65.37859365504274, -24.32618404793934 65.61118927678847, -23.65051469572309 66.26251902939522, -22.13492245125089 66.41046865504687, -20.57628373867955 65.73211212835143, -19.05684160000159 66.27660085719477, -17.79862382655905 65.99385325790978, -16.16781897629212 66.52679230413587, -14.50869544112923 66.45589223903143))",
    ],
}
countries["geometry"] = [loads(wkt) for wkt in countries["geometry"]]
countries = geopandas.GeoDataFrame(countries, crs="EPSG:4326")

# countries = geopandas.read_file(geopandas.datasets.get_path("naturalearth_lowres"))
countries = starepandas.STAREDataFrame(countries)


def test_iloc():
    subset = countries.iloc[0:1]
    assert isinstance(subset, starepandas.STAREDataFrame)


def test_conditional():
    subset = countries[countries.name == 'Iceland']
    assert isinstance(subset, starepandas.STAREDataFrame)


def test_geom():
    countries['geom2'] = countries['geometry']
    countries.set_geometry('geom2', inplace=True)
    sdf = starepandas.STAREDataFrame(countries)
    assert sdf._geometry_column_name == countries._geometry_column_name